/*
 * SPEasyForms - modify SharePoint forms using jQuery (i.e. put fields on
 * tabs, show/hide fields, validate field values, modify the controls used
 * to enter field values etc.)
 *
 * @version 2015.01
 * @requires jQuery.SPEasyForms.2015.01 
 * @requires jQuery-ui v1.9.2 
 * @requires jQuery.SPServices v2015.01 or greater
 * @optional ssw Session Storage Wrapper - Cross Document Transport of
 *    JavaScript Data; used to cache the context across pages if available
 *    and options.useCache === true
 * @copyright 2014-2015 Joe McShea
 * @license under the MIT license:
 *    http://www.opensource.org/licenses/mit-license.php
 */
function shouldSPEasyFormsRibbonButtonBeEnabled(){return spefjQuery.spEasyForms.isConfigurableList()?!0:!1}spefjQuery=jQuery.noConflict(!0),function(n,t){var r,i;Object.keys||(Object.keys=function(t){return n.map(t,function(n,t){return t})});Object.create||(Object.create=function(n){function t(){}return t.prototype=n,new t});r=typeof ssw!="undefined"?ssw.get():t;n.spEasyForms={defaults:{useCache:typeof ssw!="undefined"||typeof ssw_init!="undefined",maxWebCache:6,maxListCache:10,jQueryUITheme:t,css:t,formBodySelector:"table td.ms-formbody",fieldInternalNameRegex:/FieldInternalName=\"([^\"]*)\"/i,fieldDisplayNameRegex:/FieldName=\"([^\"]*)\"/i,fieldTypeRegex:/FieldType=\"([^\"]*)\"/i,fieldDisplayNameAltSelector:"h3.ms-standardheader",verbose:window.location.href.indexOf("spEasyFormsVerbose=true")>=0,initAsync:window.location.href.indexOf("spEasyFormsAsync=false")<0,version:"2015.01"},isConfigurableList:function(t){var r=n.extend({},i.defaults,t);return(r.currentListContext||(r.currentListContext=n.spEasyForms.sharePointContext.getListContext(this.defaults)),!r.currentListContext)?!1:r.currentListContext.template==="102"||r.currentListContext.template==="108"?!1:!0},init:function(t){var r=n.extend({},i.defaults,t),u,f;this.initCacheLibrary(r);this.loadDynamicStyles(r);r.callback=i.contextReady;this.options=r;n("#spEasyFormsBusyScreen").dialog({autoOpen:!1,dialogClass:"speasyforms-busyscreen",closeOnEscape:!1,draggable:!1,width:250,minHeight:25,modal:!0,buttons:{},resizable:!1});n("#spEasyFormsBusyScreen").html("Initializing Form...").dialog("open");r.initAsync?n.spEasyForms.sharePointContext.initAsync(r):this.contextReady(t);ExecuteOrDelayUntilScriptLoaded(function(){var t=SP.UI.ModalDialog.get_childDialog();t!==null&&setTimeout(function(){var t;if(n(".ms-formtable").css("display")==="none"||n("#spEasyFormsContainersPre").length>0){SP.UI.ModalDialog.get_childDialog().autoSize();var i=n(".ms-dlgContent",window.parent.document),r=(n(window.top).height()-i.outerHeight())/2,u=(n(window.top).width()-i.outerWidth())/2;i.css({top:r>0?r:0,left:u>0?u:0});i.prev().css({top:r>0?r:0,left:u>0?u:0});t=n(".ms-dlgFrame",window.parent.document);t.height()>n(window.parent).height()&&t.height(n(window.parent).height());t.width()>n(window.parent).width()&&t.width(n(window.parent).width())}},3e3)},"sp.ui.dialog.js");u=n.spEasyForms.utilities.getRequestParameters();f=n.spEasyForms.sharePointFieldRows.init(t);n.each(Object.keys(u),function(t,i){if(i.indexOf("spef_")===0){var e=i.substring(5);e in f&&(r.row=f[e],r.value=u[i],n.spEasyForms.sharePointFieldRows.setValue(r))}})},contextReady:function(t){var r=n.extend({},i.defaults,t);try{r.currentContext=n.spEasyForms.sharePointContext.get(r);r.source=n.spEasyForms.utilities.getRequestParameters(r).Source;r.currentListContext=n.spEasyForms.sharePointContext.getListContext(r);i.isSettingsPage(r)?i.toEditor(r):i.isTransformable(r)?i.transform(r):i.isConfigurableListSettings(r)&&i.insertSettingsLink(r)}finally{n("table.ms-formtable ").show();n("#spEasyFormsBusyScreen").dialog("close")}return this},isConfigurableListSettings:function(t){var r=n.extend({},i.defaults,t);return i.isConfigurableList(r)?window.location.href.toLowerCase().indexOf("listedit.aspx")>=0:!1},isSettingsPage:function(t){var r=n.extend({},i.defaults,t);return i.isConfigurableList(r)?window.location.href.toLowerCase().indexOf("speasyformssettings.aspx")>=0:(window.location.href.toLowerCase().indexOf("speasyformssettings.aspx")>=0&&n("#spEasyFormsInitializationError").show(),!1)},isTransformable:function(t){var r=n.extend({},i.defaults,t);return i.isConfigurableList(r)?n.spEasyForms.visibilityRuleCollection.getFormType(r).length===0?!1:n.spEasyForms.visibilityRuleCollection.getFormType(r)==="new"&&window.location.href.toLowerCase().indexOf("&type=1&")>=0?!1:window.location.href.toLowerCase().indexOf("&contenttypeid=0x0120")>=0?!1:!0:!1},transform:function(t){if(t.currentConfig=n.spEasyForms.configManager.get(t),n(".ms-lookuptypeintextbox").each(function(){n().SPServices.SPComplexToSimpleDropdown({columnName:n(this).attr("title"),debug:t.verbose})}),n("table.ms-formtable").length===0&&n("td.ms-formlabel h3.ms-standardheader").closest("table").addClass("ms-formtable"),n.spEasyForms.containerCollection.transform(t),typeof PreSaveItem!="undefined"){var i=PreSaveItem;PreSaveItem=function(){var n=i();return n&&(n=spefjQuery.spEasyForms.containerCollection.preSaveItem()),n}}n("input[value='Save']").each(function(){var n,t;null!==this.getAttributeNode("onclick")&&(n=this.getAttributeNode("onclick").nodeValue,n=n.replace("if (SPClientForms.ClientFormManager.SubmitClientForm('WPQ2')) return false;",""),t=document.createAttribute("onclick"),t.value=n,this.setAttributeNode(t))});n.spEasyForms.appendContext(t);_spPageContextInfo.webUIVersion===4&&n(".ui-widget input").css("font-size","8pt")},toEditor:function(t){t.currentConfig=n.spEasyForms.configManager.get(t);_spPageContextInfo.webUIVersion===4?(n("#spEasyFormsContent").css({position:"static","overflow-y":"visible","overflow-x":"visible"}),n("div.speasyforms-panel").css({width:"auto",height:"auto",position:"static","overflow-y":"visible","overflow-x":"visible"}),n("td.speasyforms-form").css("padding-left","0px"),n(".s4-title-inner").css("display","none"),n(".speasyforms-ribbon").css("position","fixed"),n("#s4-bodyContainer").css("overflow-x","visible"),n(".s4-notdlg").hide(),n("#spEasyFormsOuterDiv").css({"margin-left":"-160px","margin-top":"88px"}),n("#RibbonContainer").append("<h3 class='speasyforms-breadcrumbs' style='position:fixed;top:0px;color:white;'><a href='"+t.source+"' style='color:white;'>"+t.currentListContext.title+"<\/a>  -&gt; SPEasyForms Configuration<\/h3>"),n("tr.speasyforms-sortablefields, tr.speasyforms-sortablerules").css("font-size","0.9em"),n("select[id$='DateTimeFieldDateHours']").css("font-size","8pt"),n("select[id$='DateTimeFieldDateMinutes']").css("font-size","8pt")):n(".ms-cui-topBar2").prepend("<h2 class='speasyforms-breadcrumbs'><a href='"+t.source+"'>"+t.currentListContext.title+"<\/a>  -&gt; SPEasyForms Configuration<\/h2>");n.each(t.currentListContext.contentTypes.order,function(i,r){r.indexOf("0x0120")!==0&&n("#spEasyFormsContentTypeSelect").append("<option value='"+t.currentListContext.contentTypes[r].id+"'>"+t.currentListContext.contentTypes[r].name+"<\/option>")});n("#spEasyFormsContentTypeSelect").change(function(){delete n.spEasyForms.containerCollection.rows;delete n.spEasyForms.sharePointContext.formCache;t.contentTypeChanged=!0;n.spEasyForms.containerCollection.toEditor(t)});n.spEasyForms.containerCollection.toEditor(t);n(window).on("beforeunload",function(){if(!n("#spEasyFormsSaveButton img").hasClass("speasyforms-buttonimgdisabled"))return"You have unsaved changes, are you sure you want to leave the page?"});n.spEasyForms.appendContext(t);var i=5;i+=_spPageContextInfo.webUIVersion===4?n("#s4-ribbonrow").height():n("#suiteBarTop").height()+n("#suitBar").height()+n("#s4-ribbonrow").height()+n("#spEasyFormsRibbon").height();n("div.speasyforms-panel").height(n(window).height()-i);_spPageContextInfo.webUIVersion===4?n("#spEasyFormsContent").height(n(window).height()-i).width(n(window).width()-445):n("#spEasyFormsContent").height(n(window).height()-i).width(n(window).width()-405);n(window).resize(function(){n("div.speasyforms-panel").height(n(window).height()-i);_spPageContextInfo.webUIVersion===4?n("#spEasyFormsContent").height(n(window).height()-i).width(n(window).width()-445):n("#spEasyFormsContent").height(n(window).height()-i).width(n(window).width()-405)});n("#spEasyFormsRibbon").show},insertSettingsLink:function(t){var r=n("td.ms-descriptiontext:contains('description and navigation')").closest("table"),e=n("a:contains('Permissions for this list')"),i,u,f;e.length>0&&r.length>0&&(i=window.location.href,i.indexOf("start.aspx#")>=0&&(i=n.spEasyForms.utilities.webRelativePathAsAbsolutePath(i.substring(i.indexOf("#")+1))),u=n.spEasyForms.utilities.siteRelativePathAsAbsolutePath("/Style Library/SPEasyFormsAssets/2015.01/Pages/SPEasyFormsSettings.aspx")+"?ListId="+n.spEasyForms.sharePointContext.getCurrentListId(t)+"&SiteUrl="+n.spEasyForms.sharePointContext.getCurrentSiteUrl(t)+"&Source="+encodeURIComponent(i),f="<tr><td style='padding-top: 5px;' class='ms-descriptiontext ms-linksectionitembullet' vAlign='top' width='8' noWrap='nowrap'><img alt='' src='/_layouts/images/setrect.gif?rev=37' width='5' height='5' />&nbsp;<\/td><td class='ms-descriptiontext ms-linksectionitemdescription' vAlign='top'> <a href='"+u+"'>SPEasyForms Configuration<\/a><\/td><\/tr>",r.append(f))},initCacheLibrary:function(n){typeof r=="undefined"&&n.cache!==t&&(r=n.cache);typeof ssw=="undefined"&&typeof ssw_init!="undefined"&&(ssw_init(window,document),typeof r=="undefined"&&(r=ssw.get()))},loadDynamicStyles:function(i){i.jQueryUITheme===t&&(i.jQueryUITheme=n.spEasyForms.utilities.siteRelativePathAsAbsolutePath("/Style Library/SPEasyFormsAssets/2015.01/Css/jquery-ui/jquery-ui.css"));n("head").append('<link rel="stylesheet" type="text/css" href="'+i.jQueryUITheme+'">');i.css===t&&(i.css=n.spEasyForms.utilities.siteRelativePathAsAbsolutePath("/Style Library/SPEasyFormsAssets/2015.01/Css/speasyforms.css"));n("head").append('<link rel="stylesheet" type="text/css" href="'+i.css+'">')},clearCachedContext:function(t){var u=n.extend({},i.defaults,t);u.useCache&&(r={},ssw.clear())},writeCachedContext:function(t){var u=n.extend({},i.defaults,t),f,e;typeof ssw!="undefined"&&(f="spEasyForms_spContext_"+u.currentContext.webRelativeUrl,f in r||Object.keys(r).length>=u.maxWebCache&&ssw.remove(Object.keys(r)[0]),e={},e[f]=u.currentContext,ssw.add(e))},readCachedContext:function(u){var f=n.extend({},i.defaults,u),e;return f.useCache===!0?(e="spEasyForms_spContext_",f.siteUrl&&(e+=f.siteUrl),r[e]):t},appendContext:function(){}};i=n.spEasyForms}(spefjQuery);
/*
//# sourceMappingURL=jquery.SPEasyForms.min.js.map
*/